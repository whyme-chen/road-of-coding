# 架构设计

## 理念树立

1. 架构设计没有对不对，只有合不合适。
2. 架构是一门取舍与权衡的艺术。
3. 能用简单方案解决的问题，没有必要追求技术的“高大尚”而使用复杂方案。
4. 架构&框架
   * 架构是宏观设计的标准，是系统的整体设计，涉及到组件、模块、关系等方面。
   * 框架是具体实现的规则，是为特定类型的开发提供基础结构和功能模块的工具。
5. 架构设计应该思考的问题

   * 骨架、分层、DDD
   * **扩展性**、**性能**、**稳定性**
   * 异常处理、日志、监控
   * 系统协同、安全
   * QPS计算、资源预估（CPU/内存/存储）、瓶颈分析

## 设计原则

### CAP定理

* 一致性（Consistency）：代表更新操作成功后，所有节点在同一时间的数据完全一致
* 可用性（Availability）：代表用户访问数据时，系统是否能在正常响应时间返回预期结果
* 分区容错性（Partitioning）：代表分布式系统在遇到某节点或网络故障时，仍能够对外提供满足一致性或可用性的服务

### 一致性模型

## 核心指标

延迟（Latency）、吞吐量（Throughput）、可用性（Availability）、持久性（Durability）

## 架构演进

# 负载均衡

核心内容：

* 算法（轮询、加权轮询、最小连接数）
* 硬件 vs 软件

# 缓存

核心内容：缓存策略（LRU、LFU）、缓存穿透/雪崩/击穿问题、多级缓存（Redis + Memcached + CDN）

# 数据库设计

核心内容：

- SQL vs NoSQL（如MySQL、MongoDB）。
- 分库分表（Sharding）、读写分离、主从复制、一致性哈希（Consistent Hashing）

# 消息队列

## 概念

## 主要中间件

## RPC

> RPC和MQ是分布式底层的通信基础

1. RPC：远程过程调用。像调用本地方法一样调用远程方法。

   * 在没有RPC项目中，一个接口（业务的定义）及其实现类（业务实现）都在一个项目中。
   * 二方库：也称为"内部库"或"公司内部库"，指由本地团队或组织内部开发和维护的代码库，这些库通常是为了满足组织内部的需求而开发的，不会公开发布到外部。
   * 三方库：也称为"外部库"或"第三方库"，指由外部团队或个人开发和维护的代码库，这些库通常是在公开的代码仓库或平台上发布的，可以由任何人使用，并可能具有许可证来规定其使用方式。

   > DWR是一个Java 开源库，帮助你实现 Aijax 网站。它可以让你在浏览器中的Javascript 代码调用 Web 服务器上的Java，就像在Java代码就在浏览器中一样。

2. 

### RPC基本原理

### 常见RPC框架

### RPC框架设计

# 分布式系统

核心内容：

* 分布式锁
* 分布式事务
* 架构模式
  * **分层架构**（Presentation Layer、Business Layer、Data Layer）。
  * **微服务架构**：服务拆分、API Gateway、服务网格（Service Mesh）。
  * **事件驱动架构**（Event Sourcing、CQRS）。
  * **Serverless与FaaS**：无服务器设计的适用场景

# 扩展性与容错性

- 水平扩展 vs 垂直扩展。
- 容错机制：重试、熔断（Circuit Breaker）、降级（Fallback）、限流（Rate Limiting）。
- 冗余设计：多副本、多可用区（Multi-AZ）、异地多活（Multi-Region）

# 安全与运维

- 认证与授权（OAuth 2.0、JWT）。
- 数据加密（TLS、端到端加密）。
- 监控与日志：Prometheus + Grafana、ELK Stack（Elasticsearch、Logstash、Kibana）。
- 灾难恢复（Disaster Recovery）与备份策略。

# SaaS

1. 概念理解

   "软件及服务"是指将软件产品与相关的支持和服务项组合在一起，以满足用户需求的整体解决方案。它强调了在使用软件产品时所提供的全方位支持和服务。其中，

   * 软件指的是由程序代码编写而成的应用程序或系统，它们可以运行在计算机、移动设备或其他特定的硬件平台上。软件是解决特定问题或提供特定功能的工具。
   * 服务指与软件配套的支持和服务，旨在帮助用户有效地使用和管理软件产品。这些服务包括技术支持、培训、咨询、定制化开发等，以确保软件的顺利运行和用户的满意度。

   **软件及服务的概念强调了软件作为一个整体解决方案的重要性，它不仅提供了功能和工具，还提供了使用和维护软件所需的支持和服务。**用户不仅仅获得了软件产品本身，还能享受到与之相伴的价值增值服务。通过提供软件及服务，软件供应商可以更好地满足用户需求并增加客户价值。用户可以更轻松地采用和使用软件，并在遇到问题或需要帮助时获得及时的支持。

2. 涉及知识领域

   * 软件开发：SaaS涉及软件的设计、开发和测试等方面。在构建SaaS应用程序时，需要使用合适的编程语言、开发工具和开发方法论，以确保软件的功能和性能。
   * 云计算：SaaS是云计算的一种交付模型，它依赖于云基础设施来提供软件服务。因此，了解云计算的基本原理、服务模型以及相关的技术（如虚拟化、容器化等）是理解SaaS的重要基础。
   * 网络和安全：SaaS通过互联网向用户提供服务，因此网络和安全是SaaS的重要议题。了解网络通信原理、协议、网络安全措施以及数据加密等相关知识至关重要，以确保SaaS应用程序的可靠性和安全性。
   * 数据管理：SaaS涉及与存储、管理和处理大量数据相关的任务。掌握数据库技术、数据备份和恢复、数据隐私保护等方面的知识是构建可靠的SaaS应用程序的关键。
   * 用户体验和界面设计：SaaS应用程序的用户体验对于用户的满意度和采用程度至关重要。了解人机交互、用户界面设计原则和用户体验研究等相关知识，有助于设计出易用、直观和符合用户期望的SaaS应用程序。

3. saas标准化

# 中台

将通用业务能力沉淀到中台业务模型，实现**企业级业务能力复用**。

# 领域驱动设计（DDD）

参考：

* [GitHub - evancyz/ddd-learning: DDD学习、实战资料汇总](https://github.com/evancyz/ddd-learning)
* [什么是DDD（领域驱动设计）？ 这是我见过最容易理解的一篇关于DDD 的文章了]([什么是DDD（领域驱动设计）？ 这是我见过最容易理解的一篇关于DDD 的文章了 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/361427612))

# 参考资料

* [凤凰架构](https://icyfenix.cn/)
* [system-design-primer](https://github.com/donnemartin/system-design-primer)
* 《设计数据密集型应用》
